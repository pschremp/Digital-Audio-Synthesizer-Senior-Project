/*
 * LFO.c
 *
 *	Creates a low frequency oscillator (LFO) to be used to modulate other parameters in synth engine
 *  Created on: May 10, 2024
 *      Author: Philip
 */

#include "LFO.h"
#include "stdlib.h"
#include "math.h"

#define SAMPLE_BUFFER_SIZE 2048

enum wave_shape{SQU, SAW, TRI, SIN, NOI};

int lfo_sample_index[] = {0};
float lfo_sample_value[] = {0};
float lfo_sin_lut[] = {0.5,0.50131,0.50262,0.50393,0.50524,0.50654,0.50785,0.50916,0.51047,0.51178,0.51309,0.5144,0.51571,0.51701,0.51832,0.51963,0.52094,0.52225,0.52355,0.52486,0.52617,0.52748,0.52878,0.53009,0.5314,0.5327,0.53401,0.53531,0.53662,0.53792,0.53923,0.54053,0.54184,0.54314,0.54445,0.54575,0.54705,0.54836,0.54966,0.55096,0.55226,0.55357,0.55487,0.55617,0.55747,0.55877,0.56007,0.56137,0.56267,0.56397,0.56526,0.56656,0.56786,0.56915,0.57045,0.57175,0.57304,0.57434,0.57563,0.57692,0.57822,0.57951,0.5808,0.58209,0.58338,0.58467,0.58596,0.58725,0.58854,0.58983,0.59112,0.5924,0.59369,0.59498,0.59626,0.59755,0.59883,0.60011,0.60139,0.60268,0.60396,0.60524,0.60652,0.60779,0.60907,0.61035,0.61162,0.6129,0.61418,0.61545,0.61672,0.618,0.61927,0.62054,0.62181,0.62308,0.62434,0.62561,0.62688,0.62814,0.62941,0.63067,0.63194,0.6332,0.63446,0.63572,0.63698,0.63824,0.6395,0.64075,0.64201,0.64326,0.64452,0.64577,0.64702,0.64827,0.64952,0.65077,0.65202,0.65326,0.65451,0.65575,0.657,0.65824,0.65948,0.66072,0.66196,0.6632,0.66443,0.66567,0.6669,0.66814,0.66937,0.6706,0.67183,0.67306,0.67429,0.67551,0.67674,0.67796,0.67918,0.68041,0.68163,0.68284,0.68406,0.68528,0.68649,0.68771,0.68892,0.69013,0.69134,0.69255,0.69376,0.69496,0.69617,0.69737,0.69857,0.69977,0.70097,0.70217,0.70337,0.70456,0.70576,0.70695,0.70814,0.70933,0.71052,0.7117,0.71289,0.71407,0.71526,0.71644,0.71762,0.71879,0.71997,0.72114,0.72232,0.72349,0.72466,0.72583,0.727,0.72816,0.72932,0.73049,0.73165,0.73281,0.73396,0.73512,0.73628,0.73743,0.73858,0.73973,0.74088,0.74202,0.74317,0.74431,0.74545,0.74659,0.74773,0.74887,0.75,0.75113,0.75226,0.75339,0.75452,0.75565,0.75677,0.75789,0.75901,0.76013,0.76125,0.76236,0.76348,0.76459,0.7657,0.76681,0.76791,0.76902,0.77012,0.77122,0.77232,0.77342,0.77451,0.7756,0.7767,0.77778,0.77887,0.77996,0.78104,0.78212,0.7832,0.78428,0.78536,0.78643,0.7875,0.78857,0.78964,0.79071,0.79177,0.79283,0.79389,0.79495,0.79601,0.79706,0.79811,0.79916,0.80021,0.80126,0.8023,0.80334,0.80438,0.80542,0.80645,0.80749,0.80852,0.80955,0.81057,0.8116,0.81262,0.81364,0.81466,0.81568,0.81669,0.8177,0.81871,0.81972,0.82072,0.82173,0.82273,0.82373,0.82472,0.82572,0.82671,0.8277,0.82869,0.82967,0.83066,0.83164,0.83261,0.83359,0.83457,0.83554,0.83651,0.83747,0.83844,0.8394,0.84036,0.84132,0.84227,0.84323,0.84418,0.84513,0.84607,0.84701,0.84796,0.84889,0.84983,0.85077,0.8517,0.85263,0.85355,0.85448,0.8554,0.85632,0.85724,0.85815,0.85906,0.85997,0.86088,0.86178,0.86269,0.86359,0.86448,0.86538,0.86627,0.86716,0.86805,0.86893,0.86982,0.8707,0.87157,0.87245,0.87332,0.87419,0.87506,0.87592,0.87678,0.87764,0.8785,0.87935,0.8802,0.88105,0.8819,0.88274,0.88358,0.88442,0.88526,0.88609,0.88692,0.88775,0.88857,0.8894,0.89021,0.89103,0.89185,0.89266,0.89347,0.89427,0.89508,0.89588,0.89668,0.89747,0.89826,0.89905,0.89984,0.90063,0.90141,0.90219,0.90296,0.90374,0.90451,0.90528,0.90604,0.9068,0.90756,0.90832,0.90907,0.90983,0.91057,0.91132,0.91206,0.9128,0.91354,0.91427,0.91501,0.91573,0.91646,0.91718,0.9179,0.91862,0.91934,0.92005,0.92076,0.92146,0.92216,0.92286,0.92356,0.92425,0.92495,0.92563,0.92632,0.927,0.92768,0.92836,0.92903,0.9297,0.93037,0.93104,0.9317,0.93236,0.93301,0.93367,0.93432,0.93496,0.93561,0.93625,0.93689,0.93752,0.93815,0.93878,0.93941,0.94003,0.94065,0.94127,0.94188,0.94249,0.9431,0.94371,0.94431,0.94491,0.9455,0.9461,0.94669,0.94727,0.94786,0.94844,0.94901,0.94959,0.95016,0.95073,0.95129,0.95185,0.95241,0.95297,0.95352,0.95407,0.95462,0.95516,0.9557,0.95624,0.95677,0.9573,0.95783,0.95836,0.95888,0.9594,0.95991,0.96042,0.96093,0.96144,0.96194,0.96244,0.96294,0.96343,0.96392,0.9644,0.96489,0.96537,0.96585,0.96632,0.96679,0.96726,0.96772,0.96818,0.96864,0.9691,0.96955,0.97,0.97044,0.97088,0.97132,0.97176,0.97219,0.97262,0.97304,0.97346,0.97388,0.9743,0.97471,0.97512,0.97553,0.97593,0.97633,0.97673,0.97712,0.97751,0.9779,0.97828,0.97866,0.97904,0.97941,0.97978,0.98015,0.98051,0.98087,0.98123,0.98158,0.98193,0.98228,0.98262,0.98296,0.9833,0.98363,0.98396,0.98429,0.98462,0.98494,0.98525,0.98557,0.98588,0.98618,0.98649,0.98679,0.98709,0.98738,0.98767,0.98796,0.98824,0.98852,0.9888,0.98907,0.98934,0.98961,0.98988,0.99014,0.99039,0.99065,0.9909,0.99114,0.99139,0.99163,0.99186,0.9921,0.99233,0.99255,0.99278,0.993,0.99321,0.99343,0.99364,0.99384,0.99405,0.99425,0.99444,0.99464,0.99483,0.99501,0.99519,0.99537,0.99555,0.99572,0.99589,0.99606,0.99622,0.99638,0.99653,0.99669,0.99684,0.99698,0.99712,0.99726,0.9974,0.99753,0.99766,0.99778,0.9979,0.99802,0.99814,0.99825,0.99835,0.99846,0.99856,0.99866,0.99875,0.99884,0.99893,0.99901,0.99909,0.99917,0.99924,0.99931,0.99938,0.99944,0.9995,0.99956,0.99961,0.99966,0.99971,0.99975,0.99979,0.99983,0.99986,0.99989,0.99992,0.99994,0.99996,0.99997,0.99998,0.99999,1,1,1,0.99999,0.99998,0.99997,0.99996,0.99994,0.99992,0.99989,0.99986,0.99983,0.99979,0.99975,0.99971,0.99966,0.99961,0.99956,0.9995,0.99944,0.99938,0.99931,0.99924,0.99917,0.99909,0.99901,0.99893,0.99884,0.99875,0.99866,0.99856,0.99846,0.99835,0.99825,0.99814,0.99802,0.9979,0.99778,0.99766,0.99753,0.9974,0.99726,0.99712,0.99698,0.99684,0.99669,0.99653,0.99638,0.99622,0.99606,0.99589,0.99572,0.99555,0.99537,0.99519,0.99501,0.99483,0.99464,0.99444,0.99425,0.99405,0.99384,0.99364,0.99343,0.99321,0.993,0.99278,0.99255,0.99233,0.9921,0.99186,0.99163,0.99139,0.99114,0.9909,0.99065,0.99039,0.99014,0.98988,0.98961,0.98934,0.98907,0.9888,0.98852,0.98824,0.98796,0.98767,0.98738,0.98709,0.98679,0.98649,0.98619,0.98588,0.98557,0.98525,0.98494,0.98462,0.98429,0.98396,0.98363,0.9833,0.98296,0.98262,0.98228,0.98193,0.98158,0.98123,0.98087,0.98051,0.98015,0.97978,0.97941,0.97904,0.97866,0.97828,0.9779,0.97751,0.97712,0.97673,0.97633,0.97593,0.97553,0.97512,0.97471,0.9743,0.97388,0.97347,0.97304,0.97262,0.97219,0.97176,0.97132,0.97088,0.97044,0.97,0.96955,0.9691,0.96864,0.96818,0.96772,0.96726,0.96679,0.96632,0.96585,0.96537,0.96489,0.96441,0.96392,0.96343,0.96294,0.96244,0.96194,0.96144,0.96093,0.96042,0.95991,0.9594,0.95888,0.95836,0.95783,0.9573,0.95677,0.95624,0.9557,0.95516,0.95462,0.95407,0.95352,0.95297,0.95241,0.95185,0.95129,0.95073,0.95016,0.94959,0.94901,0.94844,0.94786,0.94727,0.94669,0.9461,0.9455,0.94491,0.94431,0.94371,0.9431,0.94249,0.94188,0.94127,0.94065,0.94003,0.93941,0.93878,0.93815,0.93752,0.93689,0.93625,0.93561,0.93496,0.93432,0.93367,0.93301,0.93236,0.9317,0.93104,0.93037,0.9297,0.92903,0.92836,0.92768,0.927,0.92632,0.92564,0.92495,0.92426,0.92356,0.92286,0.92216,0.92146,0.92076,0.92005,0.91934,0.91862,0.9179,0.91718,0.91646,0.91574,0.91501,0.91428,0.91354,0.9128,0.91206,0.91132,0.91058,0.90983,0.90908,0.90832,0.90756,0.9068,0.90604,0.90528,0.90451,0.90374,0.90296,0.90219,0.90141,0.90063,0.89984,0.89906,0.89827,0.89747,0.89668,0.89588,0.89508,0.89427,0.89347,0.89266,0.89185,0.89103,0.89022,0.8894,0.88857,0.88775,0.88692,0.88609,0.88526,0.88442,0.88358,0.88274,0.8819,0.88105,0.8802,0.87935,0.8785,0.87764,0.87678,0.87592,0.87506,0.87419,0.87332,0.87245,0.87157,0.8707,0.86982,0.86893,0.86805,0.86716,0.86627,0.86538,0.86448,0.86359,0.86269,0.86179,0.86088,0.85997,0.85906,0.85815,0.85724,0.85632,0.8554,0.85448,0.85355,0.85263,0.8517,0.85077,0.84983,0.8489,0.84796,0.84702,0.84607,0.84513,0.84418,0.84323,0.84227,0.84132,0.84036,0.8394,0.83844,0.83747,0.83651,0.83554,0.83457,0.83359,0.83262,0.83164,0.83066,0.82967,0.82869,0.8277,0.82671,0.82572,0.82472,0.82373,0.82273,0.82173,0.82073,0.81972,0.81871,0.8177,0.81669,0.81568,0.81466,0.81364,0.81262,0.8116,0.81057,0.80955,0.80852,0.80749,0.80645,0.80542,0.80438,0.80334,0.8023,0.80126,0.80021,0.79916,0.79811,0.79706,0.79601,0.79495,0.79389,0.79283,0.79177,0.79071,0.78964,0.78857,0.7875,0.78643,0.78536,0.78428,0.7832,0.78212,0.78104,0.77996,0.77887,0.77779,0.7767,0.77561,0.77451,0.77342,0.77232,0.77122,0.77012,0.76902,0.76791,0.76681,0.7657,0.76459,0.76348,0.76237,0.76125,0.76013,0.75901,0.75789,0.75677,0.75565,0.75452,0.75339,0.75226,0.75113,0.75,0.74887,0.74773,0.74659,0.74545,0.74431,0.74317,0.74202,0.74088,0.73973,0.73858,0.73743,0.73628,0.73512,0.73397,0.73281,0.73165,0.73049,0.72933,0.72816,0.727,0.72583,0.72466,0.72349,0.72232,0.72115,0.71997,0.71879,0.71762,0.71644,0.71526,0.71407,0.71289,0.71171,0.71052,0.70933,0.70814,0.70695,0.70576,0.70456,0.70337,0.70217,0.70097,0.69978,0.69858,0.69737,0.69617,0.69496,0.69376,0.69255,0.69134,0.69013,0.68892,0.68771,0.68649,0.68528,0.68406,0.68285,0.68163,0.68041,0.67919,0.67796,0.67674,0.67551,0.67429,0.67306,0.67183,0.6706,0.66937,0.66814,0.6669,0.66567,0.66443,0.6632,0.66196,0.66072,0.65948,0.65824,0.657,0.65575,0.65451,0.65326,0.65202,0.65077,0.64952,0.64827,0.64702,0.64577,0.64452,0.64326,0.64201,0.64075,0.6395,0.63824,0.63698,0.63572,0.63446,0.6332,0.63194,0.63067,0.62941,0.62815,0.62688,0.62561,0.62435,0.62308,0.62181,0.62054,0.61927,0.618,0.61672,0.61545,0.61418,0.6129,0.61163,0.61035,0.60907,0.60779,0.60652,0.60524,0.60396,0.60268,0.60139,0.60011,0.59883,0.59755,0.59626,0.59498,0.59369,0.59241,0.59112,0.58983,0.58854,0.58725,0.58597,0.58468,0.58339,0.58209,0.5808,0.57951,0.57822,0.57693,0.57563,0.57434,0.57304,0.57175,0.57045,0.56916,0.56786,0.56656,0.56526,0.56397,0.56267,0.56137,0.56007,0.55877,0.55747,0.55617,0.55487,0.55357,0.55227,0.55096,0.54966,0.54836,0.54706,0.54575,0.54445,0.54314,0.54184,0.54054,0.53923,0.53793,0.53662,0.53531,0.53401,0.5327,0.5314,0.53009,0.52878,0.52748,0.52617,0.52486,0.52355,0.52225,0.52094,0.51963,0.51832,0.51701,0.51571,0.5144,0.51309,0.51178,0.51047,0.50916,0.50785,0.50655,0.50524,0.50393,0.50262,0.50131,0.5,0.49869,0.49738,0.49607,0.49477,0.49346,0.49215,0.49084,0.48953,0.48822,0.48691,0.4856,0.4843,0.48299,0.48168,0.48037,0.47906,0.47776,0.47645,0.47514,0.47383,0.47253,0.47122,0.46991,0.46861,0.4673,0.46599,0.46469,0.46338,0.46208,0.46077,0.45947,0.45816,0.45686,0.45555,0.45425,0.45295,0.45164,0.45034,0.44904,0.44774,0.44644,0.44513,0.44383,0.44253,0.44123,0.43993,0.43863,0.43733,0.43604,0.43474,0.43344,0.43214,0.43085,0.42955,0.42826,0.42696,0.42567,0.42437,0.42308,0.42178,0.42049,0.4192,0.41791,0.41662,0.41533,0.41404,0.41275,0.41146,0.41017,0.40888,0.4076,0.40631,0.40503,0.40374,0.40246,0.40117,0.39989,0.39861,0.39733,0.39605,0.39477,0.39349,0.39221,0.39093,0.38965,0.38838,0.3871,0.38583,0.38455,0.38328,0.38201,0.38073,0.37946,0.37819,0.37692,0.37566,0.37439,0.37312,0.37186,0.37059,0.36933,0.36806,0.3668,0.36554,0.36428,0.36302,0.36176,0.36051,0.35925,0.35799,0.35674,0.35549,0.35423,0.35298,0.35173,0.35048,0.34923,0.34798,0.34674,0.34549,0.34425,0.34301,0.34176,0.34052,0.33928,0.33804,0.3368,0.33557,0.33433,0.3331,0.33186,0.33063,0.3294,0.32817,0.32694,0.32572,0.32449,0.32326,0.32204,0.32082,0.3196,0.31838,0.31716,0.31594,0.31472,0.31351,0.31229,0.31108,0.30987,0.30866,0.30745,0.30624,0.30504,0.30383,0.30263,0.30143,0.30023,0.29903,0.29783,0.29663,0.29544,0.29424,0.29305,0.29186,0.29067,0.28948,0.2883,0.28711,0.28593,0.28475,0.28357,0.28239,0.28121,0.28003,0.27886,0.27768,0.27651,0.27534,0.27417,0.27301,0.27184,0.27068,0.26951,0.26835,0.26719,0.26604,0.26488,0.26373,0.26257,0.26142,0.26027,0.25912,0.25798,0.25683,0.25569,0.25455,0.25341,0.25227,0.25114,0.25,0.24887,0.24774,0.24661,0.24548,0.24435,0.24323,0.24211,0.24099,0.23987,0.23875,0.23764,0.23652,0.23541,0.2343,0.23319,0.23209,0.23098,0.22988,0.22878,0.22768,0.22658,0.22549,0.2244,0.22331,0.22222,0.22113,0.22004,0.21896,0.21788,0.2168,0.21572,0.21464,0.21357,0.2125,0.21143,0.21036,0.20929,0.20823,0.20717,0.20611,0.20505,0.20399,0.20294,0.20189,0.20084,0.19979,0.19875,0.1977,0.19666,0.19562,0.19458,0.19355,0.19251,0.19148,0.19045,0.18943,0.1884,0.18738,0.18636,0.18534,0.18432,0.18331,0.1823,0.18129,0.18028,0.17928,0.17827,0.17727,0.17627,0.17528,0.17428,0.17329,0.1723,0.17131,0.17033,0.16935,0.16836,0.16739,0.16641,0.16544,0.16446,0.16349,0.16253,0.16156,0.1606,0.15964,0.15868,0.15773,0.15677,0.15582,0.15488,0.15393,0.15299,0.15204,0.15111,0.15017,0.14924,0.1483,0.14737,0.14645,0.14552,0.1446,0.14368,0.14276,0.14185,0.14094,0.14003,0.13912,0.13822,0.13731,0.13641,0.13552,0.13462,0.13373,0.13284,0.13195,0.13107,0.13019,0.12931,0.12843,0.12755,0.12668,0.12581,0.12495,0.12408,0.12322,0.12236,0.1215,0.12065,0.1198,0.11895,0.1181,0.11726,0.11642,0.11558,0.11474,0.11391,0.11308,0.11225,0.11143,0.11061,0.10979,0.10897,0.10815,0.10734,0.10653,0.10573,0.10492,0.10412,0.10332,0.10253,0.10174,0.10095,0.10016,0.099374,0.098592,0.097813,0.097037,0.096263,0.095493,0.094724,0.093959,0.093197,0.092437,0.09168,0.090926,0.090175,0.089426,0.088681,0.087938,0.087198,0.086461,0.085726,0.084995,0.084266,0.08354,0.082817,0.082097,0.08138,0.080666,0.079954,0.079246,0.07854,0.077837,0.077137,0.07644,0.075746,0.075055,0.074366,0.073681,0.072998,0.072319,0.071642,0.070968,0.070298,0.06963,0.068965,0.068303,0.067644,0.066988,0.066335,0.065685,0.065038,0.064394,0.063753,0.063115,0.06248,0.061848,0.061218,0.060592,0.059969,0.059349,0.058732,0.058118,0.057507,0.056899,0.056294,0.055692,0.055093,0.054498,0.053905,0.053315,0.052728,0.052145,0.051564,0.050987,0.050413,0.049841,0.049273,0.048708,0.048146,0.047587,0.047031,0.046479,0.045929,0.045383,0.044839,0.044299,0.043762,0.043228,0.042697,0.042169,0.041645,0.041123,0.040605,0.04009,0.039578,0.039069,0.038563,0.038061,0.037562,0.037065,0.036572,0.036083,0.035596,0.035112,0.034632,0.034155,0.033681,0.03321,0.032743,0.032279,0.031818,0.03136,0.030905,0.030454,0.030005,0.02956,0.029118,0.02868,0.028245,0.027812,0.027384,0.026958,0.026536,0.026116,0.0257,0.025288,0.024878,0.024472,0.024069,0.02367,0.023273,0.02288,0.022491,0.022104,0.021721,0.021341,0.020964,0.020591,0.020221,0.019854,0.01949,0.01913,0.018773,0.018419,0.018069,0.017722,0.017378,0.017038,0.0167,0.016367,0.016036,0.015709,0.015385,0.015064,0.014747,0.014433,0.014123,0.013815,0.013512,0.013211,0.012914,0.01262,0.012329,0.012042,0.011758,0.011478,0.0112,0.010927,0.010656,0.010389,0.010125,0.0098648,0.0096077,0.009354,0.0091037,0.0088567,0.0086131,0.0083729,0.008136,0.0079025,0.0076724,0.0074457,0.0072223,0.0070023,0.0067857,0.0065725,0.0063626,0.0061561,0.005953,0.0057533,0.005557,0.0053641,0.0051746,0.0049884,0.0048057,0.0046263,0.0044504,0.0042778,0.0041087,0.0039429,0.0037805,0.0036216,0.003466,0.0033138,0.0031651,0.0030197,0.0028778,0.0027393,0.0026041,0.0024724,0.0023441,0.0022192,0.0020977,0.0019796,0.001865,0.0017537,0.0016459,0.0015415,0.0014405,0.0013429,0.0012487,0.001158,0.0010707,0.00098676,0.00090627,0.0008292,0.00075556,0.00068534,0.00061853,0.00055516,0.0004952,0.00043867,0.00038556,0.00033588,0.00028962,0.00024678,0.00020737,0.00017139,0.00013883,0.0001097,8.3994e-05,6.1715e-05,4.2862e-05,2.7436e-05,1.5437e-05,6.8643e-06,1.7187e-06,3.9609e-12,1.7083e-06,6.8434e-06,1.5406e-05,2.7394e-05,4.281e-05,6.1652e-05,8.3921e-05,0.00010962,0.00013874,0.00017129,0.00020726,0.00024666,0.00028948,0.00033573,0.0003854,0.0004385,0.00049502,0.00055497,0.00061834,0.00068513,0.00075534,0.00082898,0.00090603,0.00098651,0.0010704,0.0011577,0.0012485,0.0013426,0.0014402,0.0015412,0.0016456,0.0017534,0.0018646,0.0019793,0.0020974,0.0022188,0.0023437,0.002472,0.0026037,0.0027388,0.0028774,0.0030193,0.0031646,0.0033134,0.0034655,0.0036211,0.00378,0.0039424,0.0041081,0.0042773,0.0044499,0.0046258,0.0048051,0.0049879,0.005174,0.0053635,0.0055564,0.0057527,0.0059524,0.0061555,0.006362,0.0065718,0.006785,0.0070016,0.0072216,0.007445,0.0076717,0.0079018,0.0081353,0.0083722,0.0086124,0.008856,0.0091029,0.0093533,0.009607,0.009864,0.010124,0.010388,0.010655,0.010926,0.0112,0.011477,0.011757,0.012041,0.012328,0.012619,0.012913,0.01321,0.013511,0.013815,0.014122,0.014432,0.014746,0.015063,0.015384,0.015708,0.016035,0.016366,0.016699,0.017037,0.017377,0.017721,0.018068,0.018418,0.018772,0.019129,0.019489,0.019853,0.020219,0.02059,0.020963,0.02134,0.02172,0.022103,0.022489,0.022879,0.023272,0.023669,0.024068,0.024471,0.024877,0.025287,0.025699,0.026115,0.026534,0.026957,0.027382,0.027811,0.028243,0.028679,0.029117,0.029559,0.030004,0.030452,0.030904,0.031358,0.031816,0.032277,0.032742,0.033209,0.03368,0.034154,0.034631,0.035111,0.035594,0.036081,0.036571,0.037064,0.03756,0.038059,0.038562,0.039068,0.039576,0.040088,0.040604,0.041122,0.041643,0.042168,0.042696,0.043226,0.04376,0.044297,0.044838,0.045381,0.045928,0.046477,0.04703,0.047586,0.048144,0.048706,0.049271,0.04984,0.050411,0.050985,0.051563,0.052143,0.052727,0.053313,0.053903,0.054496,0.055092,0.05569,0.056292,0.056897,0.057505,0.058116,0.05873,0.059347,0.059967,0.06059,0.061216,0.061846,0.062478,0.063113,0.063751,0.064392,0.065036,0.065683,0.066333,0.066986,0.067642,0.068301,0.068963,0.069628,0.070296,0.070966,0.07164,0.072317,0.072996,0.073679,0.074364,0.075052,0.075744,0.076438,0.077135,0.077835,0.078538,0.079243,0.079952,0.080663,0.081378,0.082095,0.082815,0.083538,0.084264,0.084993,0.085724,0.086458,0.087196,0.087936,0.088678,0.089424,0.090173,0.090924,0.091678,0.092435,0.093194,0.093957,0.094722,0.09549,0.096261,0.097035,0.097811,0.09859,0.099372,0.10016,0.10094,0.10173,0.10253,0.10332,0.10412,0.10492,0.10572,0.10653,0.10734,0.10815,0.10897,0.10978,0.1106,0.11143,0.11225,0.11308,0.11391,0.11474,0.11558,0.11642,0.11726,0.1181,0.11895,0.1198,0.12065,0.1215,0.12236,0.12322,0.12408,0.12494,0.12581,0.12668,0.12755,0.12843,0.1293,0.13018,0.13107,0.13195,0.13284,0.13373,0.13462,0.13551,0.13641,0.13731,0.13821,0.13912,0.14003,0.14094,0.14185,0.14276,0.14368,0.1446,0.14552,0.14644,0.14737,0.1483,0.14923,0.15017,0.1511,0.15204,0.15298,0.15393,0.15487,0.15582,0.15677,0.15772,0.15868,0.15964,0.1606,0.16156,0.16252,0.16349,0.16446,0.16543,0.16641,0.16738,0.16836,0.16934,0.17033,0.17131,0.1723,0.17329,0.17428,0.17527,0.17627,0.17727,0.17827,0.17927,0.18028,0.18129,0.1823,0.18331,0.18432,0.18534,0.18636,0.18738,0.1884,0.18942,0.19045,0.19148,0.19251,0.19354,0.19458,0.19562,0.19666,0.1977,0.19874,0.19979,0.20084,0.20189,0.20294,0.20399,0.20505,0.20611,0.20717,0.20823,0.20929,0.21036,0.21143,0.2125,0.21357,0.21464,0.21572,0.21679,0.21787,0.21896,0.22004,0.22113,0.22221,0.2233,0.22439,0.22549,0.22658,0.22768,0.22878,0.22988,0.23098,0.23208,0.23319,0.2343,0.23541,0.23652,0.23763,0.23875,0.23987,0.24098,0.2421,0.24323,0.24435,0.24548,0.2466,0.24773,0.24887,0.25,0.25113,0.25227,0.25341,0.25455,0.25569,0.25683,0.25797,0.25912,0.26027,0.26142,0.26257,0.26372,0.26488,0.26603,0.26719,0.26835,0.26951,0.27067,0.27184,0.273,0.27417,0.27534,0.27651,0.27768,0.27885,0.28003,0.2812,0.28238,0.28356,0.28474,0.28592,0.28711,0.28829,0.28948,0.29067,0.29186,0.29305,0.29424,0.29543,0.29663,0.29783,0.29902,0.30022,0.30142,0.30263,0.30383,0.30503,0.30624,0.30745,0.30866,0.30987,0.31108,0.31229,0.3135,0.31472,0.31594,0.31715,0.31837,0.31959,0.32081,0.32204,0.32326,0.32449,0.32571,0.32694,0.32817,0.3294,0.33063,0.33186,0.33309,0.33433,0.33556,0.3368,0.33804,0.33928,0.34052,0.34176,0.343,0.34424,0.34549,0.34673,0.34798,0.34923,0.35048,0.35173,0.35298,0.35423,0.35548,0.35674,0.35799,0.35925,0.3605,0.36176,0.36302,0.36428,0.36554,0.3668,0.36806,0.36932,0.37059,0.37185,0.37312,0.37439,0.37565,0.37692,0.37819,0.37946,0.38073,0.382,0.38327,0.38455,0.38582,0.3871,0.38837,0.38965,0.39093,0.3922,0.39348,0.39476,0.39604,0.39732,0.3986,0.39989,0.40117,0.40245,0.40374,0.40502,0.40631,0.40759,0.40888,0.41017,0.41146,0.41274,0.41403,0.41532,0.41661,0.4179,0.4192,0.42049,0.42178,0.42307,0.42437,0.42566,0.42696,0.42825,0.42955,0.43084,0.43214,0.43344,0.43473,0.43603,0.43733,0.43863,0.43993,0.44123,0.44253,0.44383,0.44513,0.44643,0.44773,0.44904,0.45034,0.45164,0.45294,0.45425,0.45555,0.45685,0.45816,0.45946,0.46077,0.46207,0.46338,0.46468,0.46599,0.4673,0.4686,0.46991,0.47122,0.47252,0.47383,0.47514,0.47644,0.47775,0.47906,0.48037,0.48168,0.48298,0.48429,0.4856,0.48691,0.48822,0.48953,0.49083,0.49214,0.49345,0.49476,0.49607,0.49738,0.49869,0.5
};
float lfo_sin_lut_index[] = {0};

// Initializes values
void lfo_init(void)
{

}

// Calculates new sample values
void lfo_gen(int wave_shape, float freq, float duty_cycle, float lfo_out_buffer[], int offset)
{
	int samples_per_cycle = 48000/freq;
	float saw_increment = 1.0/(float)samples_per_cycle;
	float incr_amount = 0;

	for (int i = 0; i<SAMPLE_BUFFER_SIZE/2; i += 2)  //fills 1/2 of buffer
	{
		switch(wave_shape)
		{
			case SQU:  //creates a square wave at given frequency
				if(lfo_sample_index[0]<samples_per_cycle*duty_cycle)
				{
					lfo_out_buffer[i + offset] = 1;
				}
				else if(lfo_sample_index[0]>samples_per_cycle*duty_cycle)
				{
					lfo_out_buffer[i + offset] = 0;
				}
				lfo_sample_index[0]++;
				if(lfo_sample_index[0] >= samples_per_cycle)
				{
					lfo_sample_index[0] = 0;
				}
				break;

			case SAW:  //creates a saw wave at given frequency
				if(lfo_sample_index[0] == 0)
				{
					lfo_sample_value[0] = 1;
				}
				else
				{
					lfo_sample_value[0] -= saw_increment;

				}
				lfo_out_buffer[i + offset] = lfo_sample_value[0];
				lfo_sample_index[0]++;
				if(lfo_sample_index[0] >= samples_per_cycle)
				{
					lfo_sample_index[0] = 0;
				}
				break;

			case TRI:  //creates a triangle wave at given frequency
				if(lfo_sample_index[0] == 0)
				{
					lfo_sample_value[0] = 1;
				}
				else if (lfo_sample_index[0] <= samples_per_cycle/2)
				{
					lfo_sample_value[0] -= saw_increment*2.0;
				}
				else if (lfo_sample_index[0] > samples_per_cycle/2)
				{
					lfo_sample_value[0] += saw_increment*2.0;
				}
				lfo_out_buffer[i + offset] = lfo_sample_value[0];
				lfo_sample_index[0]++;
				if(lfo_sample_index[0] >= samples_per_cycle)
				{
					lfo_sample_index[0] = 0;
				}
				break;

			case SIN:  //creates a sine wave at given frequency
				incr_amount = (float)freq/20.f;
				lfo_out_buffer[i + offset] = lfo_sin_lut[(int)lfo_sin_lut_index[0]];
				lfo_sin_lut_index[0] += incr_amount;
				if (lfo_sin_lut_index[0] >= 2400.0)
				{
					lfo_sin_lut_index[0] -= 2400.0;
				}
				break;

			case NOI:  //creates random white noise
				lfo_out_buffer[i + offset] = (float)rand()/(float)RAND_MAX;
				lfo_sample_index[0]++;
				if(lfo_sample_index[0] >= samples_per_cycle)
				{
					lfo_sample_index[0] = 0;
				}
				break;
		}
	}
}
